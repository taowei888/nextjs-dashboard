# 页面间导航学习文档

## Next.js 导航系统实践

基于项目中实现的导航功能，这里总结了 Next.js App Router 中页面间导航的核心概念和实践经验。

## 1. Next.js 导航组件

### Link 组件的优势
Next.js 提供的 `Link` 组件相比传统的 `<a>` 标签有以下优势：

- **客户端导航**：无需完整页面刷新
- **预加载优化**：自动预加载可视区域内的链接
- **性能提升**：更快的页面切换体验
- **状态保持**：保持客户端状态和滚动位置

### 基本用法
```tsx
import Link from 'next/link';

<Link href="/dashboard">
  Dashboard
</Link>
```

## 2. 侧边导航实现

### SideNav 组件结构
```tsx
// app/ui/dashboard/sidenav.tsx
import Link from 'next/link';
import NavLinks from '@/app/ui/dashboard/nav-links';
import AcmeLogo from '@/app/ui/acme-logo';

export default function SideNav() {
  return (
    <div className="flex h-full flex-col px-3 py-4 md:px-2">
      {/* Logo 链接 - 回到首页 */}
      <Link
        className="mb-2 flex h-20 items-end justify-start rounded-md bg-blue-600 p-4 md:h-40"
        href="/"
      >
        <div className="w-32 text-white md:w-40">
          <AcmeLogo />
        </div>
      </Link>

      {/* 导航链接区域 */}
      <div className="flex grow flex-row justify-between space-x-2 md:flex-col md:space-x-0 md:space-y-2">
        <NavLinks />
        {/* 填充空间 */}
        <div className="hidden h-auto w-full grow rounded-md bg-gray-50 md:block"></div>
        {/* 登出按钮 */}
        <form>
          <button className="flex h-[48px] w-full grow items-center justify-center gap-2 rounded-md bg-gray-50 p-3 text-sm font-medium hover:bg-sky-100 hover:text-blue-600 md:flex-none md:justify-start md:p-2 md:px-3">
            <PowerIcon className="w-6" />
            <div className="hidden md:block">Sign Out</div>
          </button>
        </form>
      </div>
    </div>
  );
}
```

## 3. 动态导航链接 - NavLinks 组件

### 组件实现分析
```tsx
'use client'
import {
  UserGroupIcon,
  HomeIcon,
  DocumentDuplicateIcon,
} from '@heroicons/react/24/outline';
import Link from "next/link";
import { usePathname } from "next/navigation";
import clsx from "clsx";

// 在侧边导航中显示的链接映射。
// 根据应用程序的大小，这些数据可能会存储在数据库中。
const links = [
  { name: 'Home', href: '/dashboard', icon: HomeIcon },
  {
    name: 'Invoices',
    href: '/dashboard/invoices',
    icon: DocumentDuplicateIcon,
  },
  { name: 'Customers', href: '/dashboard/customers', icon: UserGroupIcon },
];

export default function NavLinks() {
  const pathname = usePathname();
  return (
    <>
      {links.map((link) => {
        const LinkIcon = link.icon;
        return (
          <Link
            key={link.name}
            href={link.href}
            className={clsx(
              "flex h-[48px] grow items-center justify-center gap-2 rounded-md bg-gray-50 p-3 text-sm font-medium hover:bg-sky-100 hover:text-blue-600 md:flex-none md:justify-start md:p-2 md:px-3",
              {
                "bg-sky-100 text-blue-600": pathname === link.href,
              }
            )}
          >
            <LinkIcon className="w-6" />
            <p className="hidden md:block">{link.name}</p>
          </Link>
        );
      })}
    </>
  );
}
```

### 核心功能解析

#### 1. 客户端组件声明
```tsx
'use client'
```
- **必需声明**：因为使用了 `usePathname` Hook
- **客户端渲染**：启用客户端交互功能

#### 2. 路径检测
```tsx
const pathname = usePathname();
```
- **功能**：获取当前页面路径
- **用途**：实现活跃状态高亮
- **示例**：在 `/dashboard/invoices` 页面，`pathname` 为 `/dashboard/invoices`

#### 3. 条件样式应用
```tsx
className={clsx(
  "基础样式类",
  {
    "bg-sky-100 text-blue-600": pathname === link.href,
  }
)}
```
- **clsx 库**：条件性 CSS 类名工具
- **活跃状态**：当前路径匹配时应用高亮样式
- **视觉反馈**：用户清楚知道当前所在页面

## 4. 导航链接配置

### 链接数据结构
```tsx
const links = [
  { name: 'Home', href: '/dashboard', icon: HomeIcon },
  { name: 'Invoices', href: '/dashboard/invoices', icon: DocumentDuplicateIcon },
  { name: 'Customers', href: '/dashboard/customers', icon: UserGroupIcon },
];
```

### 数据字段说明
- **name**：显示名称
- **href**：目标路径
- **icon**：Heroicons 图标组件

### 图标处理
```tsx
const LinkIcon = link.icon;
<LinkIcon className="w-6" />
```
- **动态组件**：将图标作为 React 组件使用
- **统一样式**：所有图标应用相同的 `w-6` 类

## 5. 响应式导航设计

### 移动端 vs 桌面端差异

#### 布局方向
```tsx
// SideNav 容器
"flex grow flex-row justify-between space-x-2 md:flex-col md:space-x-0 md:space-y-2"
```
- **移动端**：`flex-row` 水平布局，`space-x-2` 水平间距
- **桌面端**：`md:flex-col` 垂直布局，`md:space-y-2` 垂直间距

#### 链接样式
```tsx
// NavLinks 样式
"flex h-[48px] grow items-center justify-center gap-2 rounded-md bg-gray-50 p-3 text-sm font-medium hover:bg-sky-100 hover:text-blue-600 md:flex-none md:justify-start md:p-2 md:px-3"
```
- **移动端**：`justify-center` 居中对齐，`grow` 平分空间
- **桌面端**：`md:justify-start` 左对齐，`md:flex-none` 固定尺寸

#### 文本显示
```tsx
<p className="hidden md:block">{link.name}</p>
```
- **移动端**：`hidden` 隐藏文本，只显示图标
- **桌面端**：`md:block` 显示文本

## 6. 交互状态设计

### 悬停状态
```tsx
"hover:bg-sky-100 hover:text-blue-600"
```
- **背景变化**：悬停时背景变为浅蓝色
- **文字变化**：悬停时文字变为蓝色

### 活跃状态
```tsx
{
  "bg-sky-100 text-blue-600": pathname === link.href,
}
```
- **持续高亮**：当前页面链接保持高亮状态
- **视觉一致性**：与悬停状态使用相同颜色

### 默认状态
```tsx
"bg-gray-50 p-3 text-sm font-medium"
```
- **背景色**：浅灰色背景
- **字体**：中等粗细，小号字体

## 7. 导航性能优化

### Link 组件自动优化
- **预加载**：可视区域内的链接自动预加载
- **代码分割**：按页面分割 JavaScript 代码
- **缓存策略**：合理缓存导航目标页面

### 客户端路由
- **无刷新切换**：页面间切换无需完整刷新
- **状态保持**：保持应用状态和用户输入
- **滚动位置**：智能恢复滚动位置

## 8. 可访问性考虑

### 语义化标签
```tsx
<Link href="/dashboard/invoices">
  <LinkIcon className="w-6" />
  <p className="hidden md:block">Invoices</p>
</Link>
```
- **有意义的链接文本**：提供清晰的导航目标描述
- **图标 + 文本**：双重信息传达

### 键盘导航
- **Tab 键支持**：Link 组件自动支持键盘导航
- **焦点管理**：合理的焦点顺序和视觉反馈

## 9. 扩展和维护

### 添加新导航项
```tsx
const links = [
  // 现有链接...
  { name: 'Settings', href: '/dashboard/settings', icon: CogIcon },
  { name: 'Reports', href: '/dashboard/reports', icon: ChartBarIcon },
];
```

### 动态导航
```tsx
// 未来可以从 API 获取
const links = await fetchNavigationLinks();
```

### 权限控制
```tsx
const visibleLinks = links.filter(link => hasPermission(link.permission));
```

## 10. 学习要点总结

### 核心概念
1. **Link 组件**：Next.js 客户端导航的基础
2. **usePathname**：获取当前路径实现活跃状态
3. **条件样式**：使用 clsx 库动态应用 CSS 类
4. **响应式设计**：移动端和桌面端的布局差异

### 最佳实践
1. **组件分离**：NavLinks 独立组件便于维护
2. **数据驱动**：使用配置数组生成导航项
3. **状态反馈**：清晰的视觉状态指示
4. **性能优化**：利用 Next.js 自动优化特性

### 用户体验
1. **即时反馈**：悬停和活跃状态的视觉反馈
2. **一致性**：统一的交互模式和视觉风格
3. **适配性**：响应式设计适应不同设备
4. **可访问性**：支持键盘导航和屏幕阅读器

这个导航系统展示了现代 Web 应用中客户端路由和动态 UI 状态管理的最佳实践，为用户提供了流畅的导航体验。