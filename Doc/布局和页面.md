# 创建布局和页面文档

## Next.js App Router 布局和页面系统

基于项目中创建的 dashboard 相关页面和布局，这里总结了 Next.js App Router 的布局和页面系统学习要点。

## 1. App Router 文件约定

### 特殊文件名
- **`layout.tsx`** - 布局组件，为路由段及其子路由提供共享 UI
- **`page.tsx`** - 页面组件，定义路由的唯一 UI 内容
- **文件夹名称** - 定义路由段（URL 路径）

### 项目目录结构
```
app/
├── layout.tsx          # 根布局（全局）
├── page.tsx           # 首页 (/)
└── dashboard/         # /dashboard 路由段
    ├── layout.tsx     # dashboard 布局
    ├── page.tsx       # dashboard 首页 (/dashboard)
    ├── customers/     # /dashboard/customers 路由段
    │   └── page.tsx   # 客户页面 (/dashboard/customers)
    └── invoices/      # /dashboard/invoices 路由段
        └── page.tsx   # 发票页面 (/dashboard/invoices)
```

## 2. 嵌套布局系统

### 根布局 (app/layout.tsx)
```tsx
import "@/app/ui/global.css";
import { lusitana } from "@/app/ui/fonts";

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className={`${lusitana.className} antialiased`}>
        {children}
      </body>
    </html>
  );
}
```

**功能特点**：
- **全局应用**：所有页面都会使用这个布局
- **HTML 结构**：必须包含 `<html>` 和 `<body>` 标签
- **全局样式**：导入 global.css 和字体设置
- **children 参数**：渲染子路由内容

### Dashboard 布局 (app/dashboard/layout.tsx)
```tsx
import SideNav from "@/app/ui/dashboard/sidenav";

export default function Layout({ children }: { children: React.ReactNode }) {
  return (
    <div className="flex h-screen flex-col md:flex-row md:overflow-hidden">
      <div className="w-full flex-none md:w-64">
        <SideNav />
      </div>
      <div className="flex-grow p-6 md:overflow-y-auto md:p-12">{children}</div>
    </div>
  );
}
```

**布局特点**：
- **嵌套布局**：在根布局内部的二级布局
- **共享组件**：SideNav 侧边导航在所有 dashboard 页面中显示
- **响应式设计**：移动端垂直布局，桌面端水平布局
- **作用范围**：影响 `/dashboard/*` 所有路由

## 3. 布局层次结构

### 布局嵌套渲染
```
根布局 (app/layout.tsx)
└── Dashboard 布局 (app/dashboard/layout.tsx)
    └── 页面内容 (app/dashboard/page.tsx 或子页面)
```

### 实际渲染效果
```html
<html lang="en">
  <body class="lusitana antialiased">
    <!-- 根布局的 children 开始 -->
    <div class="flex h-screen flex-col md:flex-row md:overflow-hidden">
      <!-- 侧边导航 -->
      <div class="w-full flex-none md:w-64">
        <SideNav />
      </div>
      <!-- Dashboard 布局的 children 开始 -->
      <div class="flex-grow p-6 md:overflow-y-auto md:p-12">
        <!-- 具体页面内容 -->
        <p>Dashboard Page</p>
      </div>
      <!-- Dashboard 布局的 children 结束 -->
    </div>
    <!-- 根布局的 children 结束 -->
  </body>
</html>
```

## 4. 页面组件详解

### Dashboard 主页 (app/dashboard/page.tsx)
```tsx
export default function Page() {
  return <p>Dashboard Page</p>;
}
```

### 客户页面 (app/dashboard/customers/page.tsx)
```tsx
export default function Page() {
  return <p>customers</p>;
}
```

### 发票页面 (app/dashboard/invoices/page.tsx)
```tsx
export default function Page() {
  return <p>invoices</p>;
}
```

**页面特点**：
- **默认导出**：必须 default export 一个 React 组件
- **函数命名**：通常命名为 `Page` 组件
- **简洁实现**：当前都是简单的占位内容
- **路由映射**：文件路径直接对应 URL 路径

## 5. 路由映射关系

### URL 到文件的映射
| URL 路径 | 文件路径 | 页面内容 |
|---------|---------|---------|
| `/` | `app/page.tsx` | 首页（带图片和登录按钮） |
| `/dashboard` | `app/dashboard/page.tsx` | Dashboard Page |
| `/dashboard/customers` | `app/dashboard/customers/page.tsx` | customers |
| `/dashboard/invoices` | `app/dashboard/invoices/page.tsx` | invoices |

### 布局继承关系
```
所有页面: 根布局 (全局样式 + 字体)
├── 首页: 直接在根布局内
└── Dashboard 页面: 根布局 + Dashboard 布局 (侧边导航)
    ├── /dashboard
    ├── /dashboard/customers
    └── /dashboard/invoices
```

## 6. 响应式布局设计

### Dashboard 布局响应式分析
```tsx
<div className="flex h-screen flex-col md:flex-row md:overflow-hidden">
  {/* 侧边导航容器 */}
  <div className="w-full flex-none md:w-64">
    <SideNav />
  </div>
  {/* 主内容区域 */}
  <div className="flex-grow p-6 md:overflow-y-auto md:p-12">
    {children}
  </div>
</div>
```

**响应式特点**：
- **移动端**：`flex-col` 垂直布局，侧边导航占满宽度
- **桌面端**：`md:flex-row` 水平布局，侧边导航固定 256px 宽度
- **内容区域**：`flex-grow` 占据剩余空间
- **滚动处理**：`md:overflow-y-auto` 桌面端内容区域可滚动

## 7. 组件导入和使用

### SideNav 组件引用
```tsx
import SideNav from "@/app/ui/dashboard/sidenav";
```

**导入特点**：
- **路径别名**：使用 `@/` 指向项目根目录
- **组件位置**：位于 `app/ui/dashboard/sidenav`
- **默认导入**：使用 default import 方式

## 8. 布局系统优势

### 代码复用
- **共享导航**：SideNav 在所有 dashboard 页面自动显示
- **一致性**：保证所有相关页面的布局一致性
- **维护性**：修改布局只需要改动一个文件

### 性能优化
- **局部更新**：路由切换时只更新页面内容，布局保持不变
- **组件缓存**：共享组件可以被缓存和复用

### 用户体验
- **导航保持**：页面切换时侧边导航保持可见
- **响应式**：自动适应不同屏幕尺寸

## 9. 开发建议

### 布局规划
1. **识别共享元素**：导航、侧边栏、页脚等
2. **确定嵌套层次**：根据 URL 结构设计布局层次
3. **响应式考虑**：设计移动端和桌面端的布局差异

### 组件组织
1. **布局组件**：专门处理布局逻辑
2. **页面组件**：专注内容渲染
3. **共享组件**：放在 `app/ui` 目录统一管理

### 文件命名
1. **layout.tsx**：布局文件固定命名
2. **page.tsx**：页面文件固定命名
3. **文件夹名**：对应 URL 路径段

## 10. 下一步扩展

### 当前状态
所有页面都是简单的占位文本，为后续功能开发预留了结构。

### 可以继续添加
- **更多路由**：如 `/dashboard/settings`、`/dashboard/reports`
- **动态路由**：如 `/dashboard/invoices/[id]`
- **加载状态**：loading.tsx 文件
- **错误处理**：error.tsx 文件
- **模板**：template.tsx 文件

这个布局和页面系统为 Next.js 仪表板应用提供了清晰的结构基础，展示了 App Router 的核心概念和最佳实践。